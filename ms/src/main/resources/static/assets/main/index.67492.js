window.__require=function t(e,o,n){function r(i,s){if(!o[i]){if(!e[i]){var a=i.split("/");if(a=a[a.length-1],!e[a]){var p="function"==typeof __require&&__require;if(!s&&p)return p(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+i+"'")}i=a}var l=o[i]={exports:{}};e[i][0].call(l.exports,function(t){return r(e[i][1][t]||t)},l,l.exports,t,e,o,n)}return o[i].exports}for(var c="function"==typeof __require&&__require,i=0;i<n.length;i++)r(n[i]);return r}({BasicObjects:[function(t,e,o){"use strict";cc._RF.push(e,"50a07Qu1zdMULYJiA75UzXB","BasicObjects");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0}),o.Role=o.MessageType=void 0;var i=cc._decorator,s=i.ccclass;i.property,function(t){t.LOGIN="LOGIN",t.PLAYER_CREATE="PLAYER_CREATE",t.HERO_ATTRIBUTE="HERO_ATTRIBUTE",t.HERO_LOCATION="HERO_LOCATION",t.MONSTER_LOCATION="MONSTER_LOCATION",t.MONSTER_DIE="MONSTER_DIE"}(o.MessageType||(o.MessageType={}));o.Role=function(){this.isUpdate=!1};var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),c([s],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],ClientService:[function(t,e,o){"use strict";cc._RF.push(e,"59866lsQUZAI6eocn1mc2ZX","ClientService");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./WsConnection"),s=t("./RoleCollection"),a=t("./BasicObjects"),p=cc._decorator,l=p.ccclass,u=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.default=0,e.websocket=null,e.roleCollection=null,e.hero=null,e}return r(e,t),e.prototype.createPlayer=function(t){var e={messageType:a.MessageType.PLAYER_CREATE,createPlayerMsg:t};this.websocket.send(JSON.stringify(e))},e.prototype.update=function(){this.parseMessage()},e.prototype.parseMessage=function(){var t=this;this.websocket.getMessageStack().forEach(function(e){e.messageType==a.MessageType.HERO_ATTRIBUTE?t.roleCollection.updateHeroAttribute(e.attributeMsg):e.messageType==a.MessageType.HERO_LOCATION?t.roleCollection.updateHeroLocation(e.locationMsg):e.messageType==a.MessageType.MONSTER_LOCATION?t.roleCollection.updateMonsterLocation(e.locationMsg):e.messageType==a.MessageType.MONSTER_DIE&&t.roleCollection.monsterDie(e.roleDieMsg)}),this.websocket.clearMessageStack()},e.prototype.onLoad=function(){this.hero=this.roleCollection.getHero()},e.prototype.heartBeat=function(){if(this.websocket.isConnect()&&this.hero.attribute){var t={messageType:a.MessageType.LOGIN,playerId:this.hero.attribute.id};this.websocket.send(JSON.stringify(t))}},e.prototype.start=function(){this.schedule(this.heartBeat,1)},c([u({type:i.default})],e.prototype,"websocket",void 0),c([u({type:s.default})],e.prototype,"roleCollection",void 0),c([l],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./BasicObjects":"BasicObjects","./RoleCollection":"RoleCollection","./WsConnection":"WsConnection"}],Hero:[function(t,e,o){"use strict";cc._RF.push(e,"07d31HOCLVAUIwCV6eq4Xzh","Hero");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./func/BasicObjects"),s=cc._decorator,a=s.ccclass,p=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.default=0,e.lable=null,e.hero=new i.Role,e}return r(e,t),e.prototype.getHero=function(){return this.hero},e.prototype.update=function(){this.hero.isUpdate&&(this.hero.location&&this.node.setPosition(50*this.hero.location.x,50*this.hero.location.y),this.hero.attribute&&this.hero.location&&(this.lable.string=this.hero.attribute.name+":("+this.hero.location.x.toFixed(2)+","+this.hero.location.y.toFixed(2)+")"),this.hero.isUpdate=!1)},c([p({type:cc.Label})],e.prototype,"lable",void 0),c([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./func/BasicObjects":"BasicObjects"}],MainPage:[function(t,e,o){"use strict";cc._RF.push(e,"a0b88NepnJAkr/molmobvVn","MainPage");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../func/ClientService"),s=cc._decorator,a=s.ccclass,p=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.default=0,e.clientService=null,e}return r(e,t),e.prototype.clickStartButton=function(){this.clientService.createPlayer({name:"test"}),console.log("craate user"),this.node.active=!1},c([p({type:i.default})],e.prototype,"clientService",void 0),c([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../func/ClientService":"ClientService"}],Monsters:[function(t,e,o){"use strict";cc._RF.push(e,"2666fdy9uxCAoQN94Lvw2qI","Monsters");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,s=i.ccclass,a=i.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.default=0,e.monsterPrefab=null,e.monsters=new Map,e.deadMonster=new Array,e}return r(e,t),e.prototype.getDeadMonsters=function(){return this.deadMonster},e.prototype.getMonsters=function(){return this.monsters},e.prototype.update=function(){var t=this;this.monsters.forEach(function(e,o){var n=t.node.getChildByName(o.toString());n||((n=cc.instantiate(t.monsterPrefab)).name=o.toString(),t.node.addChild(n),console.log("add monsterNode "+n.name)),e.isUpdate&&(n.setPosition(50*e.location.x,50*e.location.y),e.isUpdate=!1)});for(var e=0,o=this.deadMonster;e<o.length;e++){var n=o[e],r=this.node.getChildByName(n.toString());r&&(r.destroy(),console.log("destory monsterNode "+r.name))}this.deadMonster.length=0},c([a({type:cc.Prefab})],e.prototype,"monsterPrefab",void 0),c([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],RoleCollection:[function(t,e,o){"use strict";cc._RF.push(e,"aafa1Bh2MJCdZCHqcNHwg+9","RoleCollection");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Hero"),s=t("../Monsters"),a=t("./BasicObjects"),p=cc._decorator,l=p.ccclass,u=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.default=0,e.heroNode=null,e.hero=null,e.monstersNode=null,e.monsters=null,e.deadMonsters=null,e}return r(e,t),e.prototype.getHero=function(){return this.hero},e.prototype.onLoad=function(){this.hero=this.heroNode.getHero(),this.monsters=this.monstersNode.getMonsters(),this.deadMonsters=this.monstersNode.getDeadMonsters()},e.prototype.updateHeroLocation=function(t){this.hero.location=t,this.hero.isUpdate=!0},e.prototype.updateHeroAttribute=function(t){this.hero.attribute=t,this.hero.isUpdate=!0},e.prototype.updateMonsterLocation=function(t){var e=t.id,o=null;this.monsters.has(e)?o=this.monsters.get(e):((o=new a.Role).id=e,this.monsters.set(e,o)),o.location=t,o.isUpdate=!0},e.prototype.monsterDie=function(t){this.deadMonsters.push(t.id)},c([u({type:i.default})],e.prototype,"heroNode",void 0),c([u({type:s.default})],e.prototype,"monstersNode",void 0),c([l],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Hero":"Hero","../Monsters":"Monsters","./BasicObjects":"BasicObjects"}],WsConnection:[function(t,e,o){"use strict";cc._RF.push(e,"01a98G0BedBlKVqBMrgZsAo","WsConnection");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i},i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,c){function i(t){try{a(n.next(t))}catch(e){c(e)}}function s(t){try{a(n.throw(t))}catch(e){c(e)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(i,s)}a((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,c,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(t){return function(e){return a([t,e])}}function a(c){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){i.label=c[1];break}if(6===c[0]&&i.label<r[1]){i.label=r[1],r=c;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(c);break}r[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(s){c=[6,s],n=0}finally{o=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,p=a.ccclass,l=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.default=0,e.isConnecting=!1,e.errorStack=[],e.messageStack=[],e}return r(e,t),e.prototype.isConnect=function(){return this.isConnecting},e.prototype.getMessageStack=function(){return this.messageStack},e.prototype.clearMessageStack=function(){this.messageStack=[]},e.prototype.onLoad=function(){this.url="ws://39.99.147.120:8080/ws",this.createWs()},e.prototype.createWs=function(){"WebSocket"in window?(this.ws=new WebSocket(this.url),this.onopen(),this.onerror(),this.onclose(),this.onmessage()):console.log("\u4f60\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 WebSocket")},e.prototype.onopen=function(){var t=this;this.ws.onopen=function(){console.log(t.ws,"onopen"),t.errorStack.forEach(function(e){t.send(e)}),t.errorStack=[],t.isConnecting=!0}},e.prototype.onerror=function(){var t=this;this.ws.onerror=function(e){console.log(e,"onerror"),t.isConnecting=!1}},e.prototype.onclose=function(){var t=this;this.ws.onclose=function(){console.log("onclose"),t.isConnecting=!1}},e.prototype.onmessage=function(){return i(this,void 0,void 0,function(){var t=this;return s(this,function(){return this.ws.onmessage=function(e){try{var o=JSON.parse(e.data);t.messageStack.push(o),console.log(o,"onmessage")}catch(n){console.log(n,"onmessage")}},[2]})})},e.prototype.reconnection=function(){this.isConnecting||(console.log("reconnection"),this.createWs())},e.prototype.start=function(){this.schedule(this.reconnection,3)},e.prototype.send=function(t){1===this.ws.readyState?this.ws.send(t):this.errorStack.push(t)},c([p],e)}(cc.Component));o.default=l,cc._RF.pop()},{}]},{},["Hero","Monsters","BasicObjects","ClientService","RoleCollection","WsConnection","MainPage"]);